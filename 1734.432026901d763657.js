"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1734],{1734:(b,v,t)=>{t.r(v),t.d(v,{LoginPage:()=>O});var m=t(5861),h=t(6814),n=t(95),l=t(1509),u=t(6689),P=t(7626),T=t(1434),E=t(6958);function I(i,s){1&i&&(u.TgZ(0,"span",12),u._uU(1," \u0631\u0642\u0645 \u0627\u0644\u0647\u0627\u062a\u0641 \u0645\u0637\u0644\u0648\u0628 "),u.qZA())}function Z(i,s){1&i&&(u.TgZ(0,"span",12),u._uU(1," \u0627\u0644\u0628\u0631\u064a\u062f \u0627\u0644\u0627\u0644\u0643\u062a\u0631\u0648\u0646\u064a \u0627\u0644\u0645\u062f\u062e\u0644 \u063a\u064a\u0631 \u0635\u062d\u064a\u062d "),u.qZA())}function L(i,s){1&i&&(u.TgZ(0,"span",12),u._uU(1," \u062d\u0642\u0644 \u0643\u0644\u0645\u0629 \u0627\u0644\u0633\u0631 \u0645\u0637\u0644\u0648\u0628 "),u.qZA())}function D(i,s){1&i&&(u.TgZ(0,"span",12),u._uU(1," \u0627\u0642\u0644 \u0639\u062f\u062f \u0644\u0644\u0627\u062d\u0631\u0641 6 "),u.qZA())}let O=(()=>{var i;class s{constructor(o,r,e,a){this.supabase=o,this.formBuilder=r,this.helper=e,this.router=a,this.isSubmitted=!1}ngOnInit(){var o=this;return(0,m.Z)(function*(){o.loginForm=o.formBuilder.group({email:["",[n.kI.required,n.kI.email]],password:["",[n.kI.required,n.kI.minLength(5),n.kI.maxLength(60)]]})})()}get errorControl(){return this.loginForm.controls}submitForm(){var o=this;return(0,m.Z)(function*(){return o.isSubmitted=!0,o.loginForm.valid?void(yield o.sendToServer(o.loginForm.value)):(yield o.helper.presentToast("Please provide all the required values!"),!1)})()}sendToServer(o){var r=this;return(0,m.Z)(function*(){yield r.helper.startLoad(),r.supabase.signIn(o.email,o.password).then(e=>{var a,g,d,_,c,f,p;if(console.log("sss: ",e),null!=e.data.user||null!=e.data.user)return localStorage.setItem("session",JSON.stringify({access_token:null===(a=e.data)||void 0===a||null===(a=a.session)||void 0===a?void 0:a.access_token,expires_at:null===(g=e.data)||void 0===g||null===(g=g.session)||void 0===g?void 0:g.expires_at,refresh_token:null==e||null===(d=e.data.session)||void 0===d?void 0:d.refresh_token})),localStorage.setItem("user",JSON.stringify({id:null===(_=e.data.user)||void 0===_?void 0:_.id,phone:null===(c=e.data.user)||void 0===c?void 0:c.phone,email:null===(f=e.data.user)||void 0===f?void 0:f.email,role:null===(p=e.data.user)||void 0===p?void 0:p.role})),console.log("session: ",JSON.parse(localStorage.getItem("session"))),console.log("user: ",JSON.parse(localStorage.getItem("user"))),r.helper.dismissLoader(),void r.router.navigate(["/"]);r.helper.dismissLoader(),r.helper.presentAlert("\u0627\u0644\u0628\u064a\u0646\u0627\u062a \u0627\u0644\u0645\u062f\u062e\u0644\u0629 \u063a\u064a\u0631 \u0635\u062d\u064a\u062d\u0629")}).catch(e=>{r.helper.dismissLoader(),console.error("err: ",e)})})()}}return(i=s).\u0275fac=function(o){return new(o||i)(u.Y36(P.T),u.Y36(n.qu),u.Y36(T.W),u.Y36(E.F0))},i.\u0275cmp=u.Xpm({type:i,selectors:[["app-login"]],standalone:!0,features:[u.jDz],decls:22,vars:7,consts:[[3,"translucent"],["color","primary"],[1,"ion-text-center"],["slot","end"],["color","light","defaultHref","/tabs/setting"],[3,"fullscreen"],["novalidate","",3,"formGroup","ngSubmit"],["lines","full"],["label","\u0627\u0644\u0628\u0631\u064a\u062f \u0627\u0644\u0627\u0644\u0643\u062a\u0631\u0648\u0646\u064a","labelPlacement","floating","name","email","formControlName","email","placeholder","\u0627\u0644\u0628\u0631\u064a\u062f \u0627\u0644\u0627\u0644\u0643\u062a\u0631\u0648\u0646\u064a"],["class","error ion-padding",4,"ngIf"],["label","\u0643\u0644\u0645\u0629 \u0627\u0644\u0633\u0631","labelPlacement","floating","formControlName","password","type","password","placeholder","\u0643\u0644\u0645\u0629 \u0627\u0644\u0633\u0631 \u0644\u062a\u0627\u0645\u064a\u0646 \u062d\u0633\u0627\u0628\u0643"],["type","submit","color","primary","expand","block"],[1,"error","ion-padding"]],template:function(o,r){1&o&&(u.TgZ(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-title",2),u._uU(3,"\u062a\u0633\u062c\u064a\u0644 \u062f\u062e\u0648\u0644"),u.qZA(),u.TgZ(4,"ion-buttons",3),u._UZ(5,"ion-back-button",4),u.qZA()()(),u.TgZ(6,"ion-content",5)(7,"form",6),u.NdJ("ngSubmit",function(){return r.submitForm()}),u.TgZ(8,"ion-card")(9,"ion-list")(10,"ion-item",7),u._UZ(11,"ion-input",8),u.qZA(),u.YNc(12,I,2,0,"span",9),u.YNc(13,Z,2,0,"span",9),u.TgZ(14,"ion-item",7),u._UZ(15,"ion-input",10),u.qZA(),u.YNc(16,L,2,0,"span",9),u.YNc(17,D,2,0,"span",9),u.qZA(),u.TgZ(18,"ion-row")(19,"ion-col")(20,"ion-button",11),u._uU(21,"\u0627\u0644\u062a\u0627\u0644\u064a"),u.qZA()()()()()()),2&o&&(u.Q6J("translucent",!0),u.xp6(6),u.Q6J("fullscreen",!0),u.xp6(1),u.Q6J("formGroup",r.loginForm),u.xp6(5),u.Q6J("ngIf",r.isSubmitted&&(null==r.errorControl.email.errors?null:r.errorControl.email.errors.required)),u.xp6(1),u.Q6J("ngIf",r.isSubmitted&&(null==r.errorControl.email.errors?null:r.errorControl.email.errors.pattern)),u.xp6(3),u.Q6J("ngIf",r.isSubmitted&&(null==r.errorControl.password.errors?null:r.errorControl.password.errors.required)),u.xp6(1),u.Q6J("ngIf",r.isSubmitted&&(null==r.errorControl.password.errors?null:r.errorControl.password.errors.minlength)))},dependencies:[l.Pc,l.oU,l.YG,l.Sm,l.PM,l.wI,l.W2,l.Gu,l.pK,l.Ie,l.q_,l.Nd,l.wd,l.sr,l.j9,l.cs,h.ez,h.O5,n.u5,n._Y,n.JJ,n.JL,n.UX,n.sg,n.u]}),s})()}}]);